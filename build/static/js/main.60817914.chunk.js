(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{127:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(58),c=n.n(o);n(71),n(72);n(59);var i=n(1),s=n.n(i),l=n(4),u=n(2),d=n(20),m=n.n(d),g=n(130),f=n(44),h=n.n(f),p=(n(88),["06:30 - 07:50","08:05 - 09:25","09:40 - 11:00","11:15 - 12:35","12:50 - 14:10","14:25 - 15:45","16:00 - 17:20","17:35 - 19:00"]),v=function(e){var t=r.useState(""),n=Object(u.a)(t,2),a=n[0],o=n[1],c=r.useState(""),i=Object(u.a)(c,2),s=i[0],l=i[1],d=r.useState(""),m=Object(u.a)(d,2),g=m[0],f=m[1];return r.useEffect((function(){console.log(e),function(){var t=localStorage.getItem("userinfo")?JSON.parse(localStorage.getItem("userinfo")):h.a.parse(window.location.search);t.name&&o(t.name),t.sso&&l(t.sso),t.mobile&&f(t.mobile),e.onChange(t)}()}),[]),r.createElement(r.Fragment,null,r.createElement("div",{className:"user"},r.createElement("input",{placeholder:"name",value:a,onChange:function(e){return o(e.target.value)}}),r.createElement("input",{placeholder:"sso",value:s,onChange:function(e){return l(e.target.value)}}),r.createElement("input",{placeholder:"mobile",style:{minWidth:"115px"},value:g,onChange:function(e){return f(e.target.value)}}),r.createElement("button",{onClick:function(){if(s&&a&&g){localStorage.setItem("userinfo",JSON.stringify({name:a,sso:s,mobile:g}));var t=h.a.stringify({sso:s,name:a,mobile:g});window.history.pushState(null,"","".concat(window.location.pathname,"?").concat(t))}e.onChange({name:a,sso:s,mobile:g})}},"\u4fdd\u5b58")),r.createElement("div",{className:"hint"},"\u5efa\u8bae\u4fdd\u5b58\u7528\u6237\u4fe1\u606f\u540e\u518d\u6536\u85cf\u5730\u5740"))},y=function(e){var t=e.user,n=e.onChange,a=e.update,o=r.useState([]),c=Object(u.a)(o,2),i=c[0],d=c[1],g=r.useState(""),f=Object(u.a)(g,2),h=f[0],p=f[1],v=function(){var e=Object(l.a)(s.a.mark((function e(){var r,a,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||!t.sso){e.next=11;break}return e.next=3,fetch("http://gymbooking.gechina.com.cn/api/v1/getLastGymRegFormsBySSO?sso=".concat(t.sso));case 3:return r=e.sent,e.next=6,r.json();case 6:a=e.sent,(o=a.data).sort((function(e,t){return m()(e.reg_date,"YYYY-MM-DD")-m()(t.reg_date,"YYYY-MM-DD")})),d(o),n(o);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),y=function(){var e=Object(l.a)(s.a.mark((function e(){var t,n,r,a,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((t=i.filter((function(e){return e.checked})).map((function(e){return e.reg_id}))).length>0)){e.next=12;break}return e.next=4,fetch("http://gymbooking.gechina.com.cn/api/v1/cancelGymRegList",{method:"POST",body:JSON.stringify(t.map((function(e){return{reg_id:e}})))});case 4:return n=e.sent,e.next=7,n.json();case 7:r=e.sent,a=r.errorMessage,o=r.result,p(a||o),v();case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),b=function(e){var t=i.find((function(t){return t.reg_id===e.target.value}));t&&(t.checked=e.target.checked),d(i)};return r.useEffect((function(){v()}),[t,a]),r.createElement("div",{className:"reserved"},r.createElement("h4",{style:{textAlign:"center"}},"\u5df2\u9884\u7ea6"),Array.isArray(i)&&i.length>0?i.map((function(e){return r.createElement("div",{key:e.reg_id,className:"reserved-item"},r.createElement("div",null,r.createElement("input",{key:e.reg_id,type:"checkbox",value:e.reg_id,onChange:b,checked:e.checked})),r.createElement("div",null,"Date: ",e.reg_date),r.createElement("div",null,"Time: ",e.reg_schedule_detail))})):r.createElement("div",null,"\u65e0\u9884\u7ea6"),r.createElement("button",{onClick:y},"\u53d6\u6d88\u9884\u7ea6"),r.createElement("div",{className:"message"},h))},b=function(e){var t=e.user,n=e.reserved,a=e.onChange,o=r.useState(!1),c=Object(u.a)(o,2),i=c[0],d=c[1],f=r.useState(!1),h=Object(u.a)(f,2),v=(h[0],h[1],r.useState("")),y=Object(u.a)(v,2),b=y[0],S=y[1],w=r.useState([]),x=Object(u.a)(w,2),O=x[0],j=x[1],_=r.useState({}),C=Object(u.a)(_,2),Y=C[0],M=C[1],N=r.useState(""),A=Object(u.a)(N,2),G=A[0],T=A[1],D=r.useState(1),R=Object(u.a)(D,2),W=R[0],J=R[1];r.useEffect((function(){P(),L()}),[]);var L=function(){for(var e=0;e<5;e++){var t=m()().add(e,"days").format("YYYY-MM-DD");O.push(t),j(O)}},P=function(){var e=m()().format("YYYY-MM-DD");console.log("setToday",e),S(e)},F=function(e){console.log(e.target.value),S(e.target.value)},I={display:"block",height:"30px",lineHeight:"30px"},B=function(){var e=Object(l.a)(s.a.mark((function e(){var n,r,o,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t&&t.sso&&t.name&&t.mobile)){e.next=11;break}return e.next=3,fetch("http://gymbooking.gechina.com.cn/api/v1/createGymRegForm",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reg_date:b,reg_schedule_id:W,reg_ssoid:t.sso,reg_username:t.name,reg_mobile:t.mobile,reg_status:!0})});case 3:return n=e.sent,e.next=6,n.json();case 6:r=e.sent,o=r.errorMessage,c=r.result,T(o||c),"done"===c&&a();case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),U=function(){var e=Object(l.a)(s.a.mark((function e(){var t,n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d(!0),Y[b]=[],M(Y),t=function(){var e=Object(l.a)(s.a.mark((function e(t){var n,r,a,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://gymbooking.gechina.com.cn/api/v1/getLastGymRegFormsBySSO?sso=".concat(t));case 2:return n=e.sent,e.next=5,n.json();case 5:if(r=e.sent,a=r.data,!(null===(o=a.find((function(e){return e.reg_date===b})))||void 0===o?void 0:o.reg_id)){e.next=14;break}return e.next=11,fetch("http://gymbooking.gechina.com.cn/api/v1/cancelGymRegList",{method:"POST",body:JSON.stringify([{reg_id:null===o||void 0===o?void 0:o.reg_id}])});case 11:return n=e.sent,e.next=14,n.json();case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n=function(){var e=Object(l.a)(s.a.mark((function e(r,a){var o,c,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o="21"+Math.random().toString().slice(-7),e.next=3,fetch("http://gymbooking.gechina.com.cn/api/v1/createGymRegForm",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reg_date:b,reg_schedule_id:r,reg_ssoid:o,reg_username:"   ",reg_mobile:E(),reg_status:!0})});case 3:return c=e.sent,e.next=6,c.json();case 6:if(i=e.sent,i.errorMessage,"done"!==i.result){e.next=13;break}return a.push(r),e.next=13,t(o);case 13:if(!(r<8)){e.next=16;break}return e.next=16,n(r+1,a);case 16:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),r=[],e.next=8,n(1,r);case 8:Y[b]=r,M(Y),d(!1);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.createElement("div",{className:"reserve-form"},r.createElement("h4",{style:{textAlign:"center"}},"\u8fdb\u884c\u9884\u7ea6"),r.createElement("div",{style:{display:"flex",justifyContent:"space-around"}},r.createElement("div",null,r.createElement("div",null,"\u65e5\u671f: ",r.createElement("input",{type:"date",value:b,onChange:F,style:{display:"inline-block"}})),r.createElement(g.default.Group,{onChange:F,value:b},O.map((function(e){return r.createElement(k,{key:e,value:e,style:I,reserved:n})})))),r.createElement("div",null,r.createElement("div",{style:{height:"26px",lineHeight:"26px"}},"\u65f6\u6bb5:",i?" \u67e5\u8be2\u4e2d...":r.createElement("button",{onClick:U},"\u5237\u65b0\u53ef\u7528")),r.createElement(g.default.Group,{onChange:function(e){J(e.target.value)},value:W},p.map((function(e,t){var n=Y[b]&&Y[b].includes(t+1)?"\u53ef\u7528":"";return r.createElement(g.default,{key:e,style:I,value:t+1},e," ",n)}))))),r.createElement("div",{style:{display:"flex",justifyContent:"space-around"}},r.createElement("button",{onClick:B,style:{display:"block"}},"\u9884\u7ea6")),r.createElement("div",{className:"message"},G))},k=function(e){var t=e.value,n=e.style,a=e.reserved,o=r.useState("false"),c=Object(u.a)(o,2),i=c[0],s=c[1],l=a.find((function(e){return e.reg_date===t})),d=(null===l||void 0===l?void 0:l.reg_schedule_detail)?"(".concat(null===l||void 0===l?void 0:l.reg_schedule_detail,")"):"";return r.useEffect((function(){fetch("http://gymbooking.gechina.com.cn/api/v1/checkDate?date=".concat(t)).then((function(e){return e.json()})).then((function(e){var t=e.result;s("ok"===t?"true":"false")}))}),[t]),r.createElement(g.default,{style:n,disabled:"false"===i,value:t},t.substring(5,t.length)," ",d)};function E(){return new Array("139","138","137","136","135","134","159","158","157","150","151","152","188","187","182","183","184","178","130","131","132","156","155","186","185","176","133","153","189","180","181","177")[parseInt(10*Math.random(),10)]+Math.random().toString().replace("0.","").slice(0,8)}var S=function(e){var t=r.useState(null),n=Object(u.a)(t,2),a=n[0],o=n[1],c=r.useState(0),i=Object(u.a)(c,2),s=i[0],l=i[1],d=r.useState([]),m=Object(u.a)(d,2),g=m[0],f=m[1];return r.createElement("div",null,r.createElement("h2",{style:{textAlign:"center"}},"Gym Revervation"),r.createElement(v,{onChange:o}),r.createElement(y,{user:a,onChange:f,update:s}),r.createElement(b,{user:a,reserved:g,onChange:function(){return l(s+1)}}),r.createElement("div",{style:{textAlign:"center",color:"darkblue",marginTop:"20px"},onClick:function(){document.querySelector("input[placeholder='sso'").select(),document.execCommand("copy",!1),window.location.href="http://gymbooking.gechina.com.cn/gym.html"}},"Copy SSO \u2192 Gym Site"),r.createElement("div",{style:{textAlign:"center",marginTop:"20px"}},r.createElement("a",{href:"http://gymbooking.gechina.com.cn/gym.html"},"Go Gym Site")))},w=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function x(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}n(126);c.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(S,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/gym",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/gym","/service-worker.js");w?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):x(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):x(t,e)}))}}()},66:function(e,t,n){e.exports=n(127)},71:function(e,t,n){},72:function(e,t,n){},88:function(e,t,n){}},[[66,1,2]]]);
//# sourceMappingURL=main.60817914.chunk.js.map