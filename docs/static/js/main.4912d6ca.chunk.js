(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{127:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(58),c=n.n(o);n(71),n(72);n(59);var i=n(1),s=n.n(i),l=n(4),u=n(2),d=n(20),f=n.n(d),m=n(130),g=n(44),v=n.n(g),p=(n(88),["06:30 - 07:50","08:05 - 09:25","09:40 - 11:00","11:15 - 12:35","12:50 - 14:10","14:25 - 15:45","16:00 - 17:20","17:35 - 19:00"]),h="http://gymbooking.ge.com.cn",y=function(e){var t=r.useState(""),n=Object(u.a)(t,2),a=n[0],o=n[1],c=r.useState(""),i=Object(u.a)(c,2),s=i[0],l=i[1],d=r.useState(""),f=Object(u.a)(d,2),m=f[0],g=f[1];return r.useEffect((function(){console.log(e),function(){var t=localStorage.getItem("userinfo")?JSON.parse(localStorage.getItem("userinfo")):v.a.parse(window.location.search);t.name&&o(t.name),t.sso&&l(t.sso),t.mobile&&g(t.mobile),e.onChange(t)}()}),[]),r.createElement(r.Fragment,null,r.createElement("div",{className:"user"},r.createElement("input",{placeholder:"name",value:a,onChange:function(e){return o(e.target.value)}}),r.createElement("input",{placeholder:"sso",value:s,onChange:function(e){return l(e.target.value)}}),r.createElement("input",{placeholder:"mobile",style:{minWidth:"115px"},value:m,onChange:function(e){return g(e.target.value)}}),r.createElement("button",{onClick:function(){if(s&&a&&m){localStorage.setItem("userinfo",JSON.stringify({name:a,sso:s,mobile:m}));var t=v.a.stringify({sso:s,name:a,mobile:m});window.history.pushState(null,"","".concat(window.location.pathname,"?").concat(t))}e.onChange({name:a,sso:s,mobile:m})}},"\u4fdd\u5b58")),r.createElement("div",{className:"hint"},"\u5efa\u8bae\u4fdd\u5b58\u7528\u6237\u4fe1\u606f\u540e\u518d\u6536\u85cf\u5730\u5740"))},b=function(e){var t=e.user,n=e.onChange,a=e.update,o=r.useState([]),c=Object(u.a)(o,2),i=c[0],d=c[1],m=r.useState(""),g=Object(u.a)(m,2),v=g[0],p=g[1],y=function(){var e=Object(l.a)(s.a.mark((function e(){var r,a,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||!t.sso){e.next=11;break}return e.next=3,fetch("".concat(h,"/api/v1/getLastGymRegFormsBySSO?sso=").concat(t.sso));case 3:return r=e.sent,e.next=6,r.json();case 6:a=e.sent,(o=a.data).sort((function(e,t){return f()(e.reg_date,"YYYY-MM-DD")-f()(t.reg_date,"YYYY-MM-DD")})),d(o),n(o);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),b=function(){var e=Object(l.a)(s.a.mark((function e(){var t,n,r,a,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((t=i.filter((function(e){return e.checked})).map((function(e){return e.reg_id}))).length>0)){e.next=12;break}return e.next=4,fetch("".concat(h,"/api/v1/cancelGymRegList"),{method:"POST",body:JSON.stringify(t.map((function(e){return{reg_id:e}})))});case 4:return n=e.sent,e.next=7,n.json();case 7:r=e.sent,a=r.errorMessage,o=r.result,p(a||o),y();case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),E=function(e){var t=i.find((function(t){return t.reg_id===e.target.value}));t&&(t.checked=e.target.checked),d(i)};return r.useEffect((function(){y()}),[t,a]),r.createElement("div",{className:"reserved"},r.createElement("h4",{style:{textAlign:"center"}},"\u5df2\u9884\u7ea6"),Array.isArray(i)&&i.length>0?i.map((function(e){return r.createElement("div",{key:e.reg_id,className:"reserved-item"},r.createElement("div",null,r.createElement("input",{key:e.reg_id,type:"checkbox",value:e.reg_id,onChange:E,checked:e.checked})),r.createElement("div",null,"Date: ",e.reg_date),r.createElement("div",null,"Time: ",e.reg_schedule_detail))})):r.createElement("div",null,"\u65e0\u9884\u7ea6"),r.createElement("button",{onClick:b},"\u53d6\u6d88\u9884\u7ea6"),r.createElement("div",{className:"message"},v))},E=function(e){var t=e.user,n=e.reserved,a=e.onChange,o=r.useState(!1),c=Object(u.a)(o,2),i=c[0],d=c[1],g=r.useState(!1),v=Object(u.a)(g,2),y=(v[0],v[1],r.useState("")),b=Object(u.a)(y,2),E=b[0],w=b[1],x=r.useState([]),O=Object(u.a)(x,2),j=O[0],_=O[1],C=r.useState({}),Y=Object(u.a)(C,2),M=Y[0],N=Y[1],A=r.useState(""),G=Object(u.a)(A,2),T=G[0],D=G[1],R=r.useState(1),W=Object(u.a)(R,2),J=W[0],L=W[1];r.useEffect((function(){F(),P()}),[]);var P=function(){for(var e=0;e<5;e++){var t=f()().add(e,"days").format("YYYY-MM-DD");j.push(t),_(j)}},F=function(){var e=f()().format("YYYY-MM-DD");console.log("setToday",e),w(e)},I=function(e){console.log(e.target.value),w(e.target.value)},B={display:"block",height:"30px",lineHeight:"30px"},U=function(){var e=Object(l.a)(s.a.mark((function e(){var n,r,o,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t&&t.sso&&t.name&&t.mobile)){e.next=11;break}return e.next=3,fetch("".concat(h,"/api/v1/createGymRegForm"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reg_date:E,reg_schedule_id:J,reg_ssoid:t.sso,reg_username:t.name,reg_mobile:t.mobile,reg_status:!0})});case 3:return n=e.sent,e.next=6,n.json();case 6:r=e.sent,o=r.errorMessage,c=r.result,D(o||c),"done"===c&&a();case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),H=function(){var e=Object(l.a)(s.a.mark((function e(){var t,n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d(!0),M[E]=[],N(M),t=function(){var e=Object(l.a)(s.a.mark((function e(t){var n,r,a,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(h,"/api/v1/getLastGymRegFormsBySSO?sso=").concat(t));case 2:return n=e.sent,e.next=5,n.json();case 5:if(r=e.sent,a=r.data,!(null===(o=a.find((function(e){return e.reg_date===E})))||void 0===o?void 0:o.reg_id)){e.next=14;break}return e.next=11,fetch("".concat(h,"/api/v1/cancelGymRegList"),{method:"POST",body:JSON.stringify([{reg_id:null===o||void 0===o?void 0:o.reg_id}])});case 11:return n=e.sent,e.next=14,n.json();case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n=function(){var e=Object(l.a)(s.a.mark((function e(r,a){var o,c,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o="21"+Math.random().toString().slice(-7),e.next=3,fetch("".concat(h,"/api/v1/createGymRegForm"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reg_date:E,reg_schedule_id:r,reg_ssoid:o,reg_username:"   ",reg_mobile:k(),reg_status:!0})});case 3:return c=e.sent,e.next=6,c.json();case 6:if(i=e.sent,i.errorMessage,"done"!==i.result){e.next=13;break}return a.push(r),e.next=13,t(o);case 13:if(!(r<8)){e.next=16;break}return e.next=16,n(r+1,a);case 16:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),r=[],e.next=8,n(1,r);case 8:M[E]=r,N(M),d(!1);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.createElement("div",{className:"reserve-form"},r.createElement("h4",{style:{textAlign:"center"}},"\u8fdb\u884c\u9884\u7ea6"),r.createElement("div",{style:{display:"flex",justifyContent:"space-around"}},r.createElement("div",null,r.createElement("div",null,"\u65e5\u671f: ",r.createElement("input",{type:"date",value:E,onChange:I,style:{display:"inline-block"}})),r.createElement(m.default.Group,{onChange:I,value:E},j.map((function(e){return r.createElement(S,{key:e,value:e,style:B,reserved:n})})))),r.createElement("div",null,r.createElement("div",{style:{height:"26px",lineHeight:"26px"}},"\u65f6\u6bb5:",i?" \u67e5\u8be2\u4e2d...":r.createElement("button",{onClick:H},"\u5237\u65b0\u53ef\u7528")),r.createElement(m.default.Group,{onChange:function(e){L(e.target.value)},value:J},p.map((function(e,t){var n=M[E]&&M[E].includes(t+1)?"\u53ef\u7528":"";return r.createElement(m.default,{key:e,style:B,value:t+1},e," ",n)}))))),r.createElement("div",{style:{display:"flex",justifyContent:"space-around"}},r.createElement("button",{onClick:U,style:{display:"block"}},"\u9884\u7ea6")),r.createElement("div",{className:"message"},T))},S=function(e){var t=e.value,n=e.style,a=e.reserved,o=r.useState("false"),c=Object(u.a)(o,2),i=c[0],s=c[1],l=a.find((function(e){return e.reg_date===t})),d=(null===l||void 0===l?void 0:l.reg_schedule_detail)?"(".concat(null===l||void 0===l?void 0:l.reg_schedule_detail,")"):"";return r.useEffect((function(){fetch("".concat(h,"/api/v1/checkDate?date=").concat(t)).then((function(e){return e.json()})).then((function(e){var t=e.result;s("ok"===t?"true":"false")}))}),[t]),r.createElement(m.default,{style:n,disabled:"false"===i,value:t},t.substring(5,t.length)," ",d)};function k(){return new Array("139","138","137","136","135","134","159","158","157","150","151","152","188","187","182","183","184","178","130","131","132","156","155","186","185","176","133","153","189","180","181","177")[parseInt(10*Math.random(),10)]+Math.random().toString().replace("0.","").slice(0,8)}var w=function(e){var t=r.useState(null),n=Object(u.a)(t,2),a=n[0],o=n[1],c=r.useState(0),i=Object(u.a)(c,2),s=i[0],l=i[1],d=r.useState([]),f=Object(u.a)(d,2),m=f[0],g=f[1];return r.createElement("div",null,r.createElement("h2",{style:{textAlign:"center"}},"Gym Revervation"),r.createElement(y,{onChange:o}),r.createElement(b,{user:a,onChange:g,update:s}),r.createElement(E,{user:a,reserved:m,onChange:function(){return l(s+1)}}),r.createElement("div",{style:{textAlign:"center",color:"darkblue",marginTop:"20px"},onClick:function(){document.querySelector("input[placeholder='sso'").select(),document.execCommand("copy",!1),window.location.href="".concat(h,"/gym.html")}},"Copy SSO \u2192 Gym Site"),r.createElement("div",{style:{textAlign:"center",marginTop:"20px"}},r.createElement("a",{href:"".concat(h,"/gym.html")},"Go Gym Site")))},x=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function O(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}n(126);c.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(w,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/gym",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/gym","/service-worker.js");x?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):O(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):O(t,e)}))}}()},66:function(e,t,n){e.exports=n(127)},71:function(e,t,n){},72:function(e,t,n){},88:function(e,t,n){}},[[66,1,2]]]);
//# sourceMappingURL=main.4912d6ca.chunk.js.map